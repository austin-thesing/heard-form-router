(function(){var B={FORM_FIELDS:{multiOwner:"is_your_practice_a_c_corp_or_our_does_it_have_multiple_owners_",state:"state",practiceSetup:"how_is_your_business_setup__v2",income:"what_is_your_expected_annual_income_for_2024___1099__private_practice_",practiceRunning:"how_long_have_you_been_running_your_private_practice_",profession:"what_best_describes_your_practice_",employeeCount:"does_your_practice_employ_any_w2_employees_or_1099_contractors_who_see_patients_"},HUBSPOT_CALENDARS:{SOLE_PROP:{url:"https://meetings.hubspot.com/bz/consultations?embed=true",title:"Schedule a Call"},S_CORP:{url:"https://meetings.hubspot.com/bz/consultation?embed=true",title:"Schedule a Call"}},LANDING_PAGES:{FREE_TRIAL:"/thank-you/free-trial",SCHEDULER:"/thank-you/schedule",NOT_QUALIFIED:"/thank-you/success"},DISQUALIFYING_CONDITIONS:{multiOwner:["yes"],state:["international"],practiceSetup:["c corp"],income:["none","less than $20,000"],profession:["dietician","nutritionist","massage therapist","dietician or nutritionist","dietetics or nutrition counseling"],practiceRunning:["opening practice in 1+ month","opening in 1+ months"],employeeCount:["yes (more than 10 employees)"]},INCOME_TIERS:{QUALIFIED_INCOME:["$20,000 - $49,999","$50,000 - $99,999","more than $100,000"]},determineRoute(H){let q=(H[this.FORM_FIELDS.multiOwner]||"").toLowerCase(),K=(H[this.FORM_FIELDS.state]||"").toLowerCase(),W=(H[this.FORM_FIELDS.practiceSetup]||"").toLowerCase(),M=(H[this.FORM_FIELDS.income]||"").toLowerCase(),J=(H[this.FORM_FIELDS.practiceRunning]||"").toLowerCase(),X=(H[this.FORM_FIELDS.profession]||"").toLowerCase(),Y=(H[this.FORM_FIELDS.employeeCount]||"").toLowerCase();console.log("Form Router Debug:",{multiOwner:q,state:K,practiceSetup:W,income:M,practiceRunning:J,profession:X,employeeCount:Y,formData:H});let Z=this.DISQUALIFYING_CONDITIONS.multiOwner.includes(q)||this.DISQUALIFYING_CONDITIONS.state.includes(K)||this.DISQUALIFYING_CONDITIONS.practiceSetup.includes(W)||this.DISQUALIFYING_CONDITIONS.income.includes(M)||this.DISQUALIFYING_CONDITIONS.profession.some((V)=>X.includes(V))||this.DISQUALIFYING_CONDITIONS.practiceRunning.includes(J)||this.DISQUALIFYING_CONDITIONS.employeeCount.includes(Y);if(console.log("isDQ",Z),Z)return console.log("Form Router: Not qualified due to DQ conditions"),"NOT_QUALIFIED";console.log("Form Router: Checking income qualification. Current income value:",M),console.log("Form Router: Looking for income in qualified tiers:",this.INCOME_TIERS.QUALIFIED_INCOME);let $=this.INCOME_TIERS.QUALIFIED_INCOME.map((V)=>{let j=M.includes(V.toLowerCase());return console.log(`Form Router: Does income "${M}" include "${V.toLowerCase()}"? ${j}`),j}).some((V)=>V===!0);if(console.log("Form Router: Is income qualified?",$),$)return console.log("Form Router: Qualified for scheduler"),"SCHEDULER";return console.log("Form Router: Not qualified (default)"),"NOT_QUALIFIED"}};if(typeof window!=="undefined")window.FormRouterConfig=B;var P=!1;function x(){if(P)return;let H=document.querySelector(".right_step_form form");if(!H){setTimeout(x,500);return}console.log("MS Form - Adding field tracking"),H.querySelectorAll("input, select").forEach((q)=>{q.addEventListener("change",function(K){console.log("MS Form - Field Changed:",{name:K.target.name,value:K.target.value})})}),P=!0}window.addEventListener("message",function(H){if(H.data.type==="hsFormCallback"){if(H.data.eventName==="onFormReady")console.log("MS Form - Form Ready"),setTimeout(x,1000);if(H.data.eventName==="onFormSubmit"){console.log("MS Form - Form Submitted");let q;try{q=JSON.parse(localStorage.getItem("hubspot_form_data")||"{}"),console.log("MS Form - Retrieved stored form data:",q)}catch(J){console.error("MS Form - Failed to retrieve stored form data:",J),q={}}let K=H.data.data;if(K&&Array.isArray(K))console.log("MS Form - Raw HubSpot form fields:",K),K.forEach((J)=>{console.log(`MS Form - Field: "${J.name}" = "${J.value}"`),q[J.name]=J.value});let W=new Date().toISOString();if(console.log("MS Form - Final form data:",q),console.log("MS Form - Expected field names:",{multiOwner:B.FORM_FIELDS.multiOwner,state:B.FORM_FIELDS.state,practiceSetup:B.FORM_FIELDS.practiceSetup,income:B.FORM_FIELDS.income,practiceRunning:B.FORM_FIELDS.practiceRunning,profession:B.FORM_FIELDS.profession,employeeCount:B.FORM_FIELDS.employeeCount}),console.log("MS Form - Field existence check:",{multiOwner:q.hasOwnProperty(B.FORM_FIELDS.multiOwner),state:q.hasOwnProperty(B.FORM_FIELDS.state),practiceSetup:q.hasOwnProperty(B.FORM_FIELDS.practiceSetup),income:q.hasOwnProperty(B.FORM_FIELDS.income),practiceRunning:q.hasOwnProperty(B.FORM_FIELDS.practiceRunning),profession:q.hasOwnProperty(B.FORM_FIELDS.profession),employeeCount:q.hasOwnProperty(B.FORM_FIELDS.employeeCount)}),Object.keys(q).length===0)console.error("MS Form - No form data available"),Sentry.captureMessage("MS Form: No form data available",{level:"error",tags:{type:"hubspot_submission",form:"ms_hubspot_contact"},extra:{eventData:H.data,submissionTime:W,formElement:document.querySelector(".right_step_form form")?.outerHTML}});let M=B.determineRoute(q);console.log("MS Form - Determined route:",M),setTimeout(()=>{try{let J=B.LANDING_PAGES[M];console.log("MS Form - Redirecting to:",J)}catch(J){console.error("MS Form - Redirect failed:",J),Sentry.captureException(J,{extra:{context:"MS Form redirect failed",route:M,formData:q},tags:{type:"redirect",form:"ms_hubspot_contact"}})}},700)}}});
})();