(function(){var _={FORM_FIELDS:{multiOwner:"is_your_practice_a_c_corp_or_our_does_it_have_multiple_owners_",state:"state",practiceSetup:"how_is_your_business_setup__v2",income:"what_is_your_expected_annual_income_for_2024___1099__private_practice_",practiceRunning:"how_long_have_you_been_running_your_private_practice_",profession:"what_best_describes_your_practice_",employeeCount:"does_your_practice_employ_any_w2_employees_or_1099_contractors_who_see_patients_"},HUBSPOT_CALENDARS:{SOLE_PROP:{url:"https://meetings.hubspot.com/bz/consultations?embed=true",title:"Schedule a Call"},S_CORP:{url:"https://meetings.hubspot.com/bz/consultation?embed=true",title:"Schedule a Call"}},LANDING_PAGES:{FREE_TRIAL:"/thank-you/free-trial",SCHEDULER:"/thank-you/schedule",NOT_QUALIFIED:"/thank-you/success"},DISQUALIFYING_CONDITIONS:{multiOwner:["yes"],state:["international"],practiceSetup:["c corp"],income:["none","less than $20,000"],profession:["dietician","nutritionist","massage therapist","dietician or nutritionist","dietetics or nutrition counseling"],practiceRunning:["opening practice in 1+ month","opening in 1+ months"],employeeCount:["yes (more than 10 employees)"]},INCOME_TIERS:{QUALIFIED_INCOME:["$20,000 - $49,999","$50,000 - $99,999","more than $100,000"]},determineRoute(A){let B=(A[this.FORM_FIELDS.multiOwner]||"").toLowerCase(),H=(A[this.FORM_FIELDS.state]||"").toLowerCase(),K=(A[this.FORM_FIELDS.practiceSetup]||"").toLowerCase(),V=(A[this.FORM_FIELDS.income]||"").toLowerCase(),J=(A[this.FORM_FIELDS.practiceRunning]||"").toLowerCase(),Y=(A[this.FORM_FIELDS.profession]||"").toLowerCase(),I=(A[this.FORM_FIELDS.employeeCount]||"").toLowerCase();console.log("Form Router Debug:",{multiOwner:B,state:H,practiceSetup:K,income:V,practiceRunning:J,profession:Y,employeeCount:I,formData:A});let X=this.DISQUALIFYING_CONDITIONS.multiOwner.includes(B)||this.DISQUALIFYING_CONDITIONS.state.includes(H)||this.DISQUALIFYING_CONDITIONS.practiceSetup.includes(K)||this.DISQUALIFYING_CONDITIONS.income.includes(V)||this.DISQUALIFYING_CONDITIONS.profession.some((Z)=>Y.includes(Z))||this.DISQUALIFYING_CONDITIONS.practiceRunning.includes(J)||this.DISQUALIFYING_CONDITIONS.employeeCount.includes(I);if(console.log("isDQ",X),X)return console.log("Form Router: Not qualified due to DQ conditions"),"NOT_QUALIFIED";if(this.INCOME_TIERS.QUALIFIED_INCOME.some((Z)=>V.includes(Z)))return console.log("Form Router: Qualified for scheduler"),"SCHEDULER";return console.log("Form Router: Not qualified (default)"),"NOT_QUALIFIED"}};if(typeof window!=="undefined")window.FormRouterConfig=_;function q(A){if(!A||typeof A!=="object")return console.error("Form data is missing or invalid"),window.location.href="https://joinheard.com",null;let B=(A[_.FORM_FIELDS.practiceSetup]||"").toLowerCase(),H=(A[_.FORM_FIELDS.employeeCount]||"").toLowerCase();if(console.log("Form data detected:",{practiceSetup:B,employeeCount:H}),!B||!H)return console.error("Required form fields are missing",{practiceSetup:B,employeeCount:H}),window.location.href="https://joinheard.com/welcome-form",null;let K=B.includes("s corp"),V=B.includes("llc")||B.includes("pllc")||B.includes("sole prop"),J=H.includes("less than 5")||H.includes("5-10");if(console.log("Business type analysis:",{isScorp:K,isLLCorSoleProp:V,hasSmallTeam:J,practiceSetup:B,employeeCount:H}),K||V&&J)return console.log("Routing to S_CORP calendar due to:",{reason:K?"S Corp detected":"LLC/Sole Prop with small team"}),"S_CORP";let Y=B.includes("sole prop"),I=H.includes("no");if(Y&&I)return console.log("Routing to SOLE_PROP calendar due to sole proprietorship with no employees"),"SOLE_PROP";return console.log("Routing to SOLE_PROP calendar as default case"),"SOLE_PROP"}function M(A){let H=`; ${document.cookie}`.split(`; ${A}=`);if(H.length===2)return H.pop().split(";").shift();return null}function N(A){let B=_.HUBSPOT_CALENDARS[A];console.log("Creating scheduler modal:",{calendarType:A,calendarTitle:B.title,calendarUrl:B.url});let H=document.createElement("div");H.id="scheduler-container",H.style.cssText=`
    width: 100%;
    max-width: 800px;
    height: 90vh;
    margin: 20px auto;
    background: white;
    border-radius: 8px;
    padding: 20px;
  `;let K=document.createElement("h2");K.textContent=B.title,K.style.cssText=`
    margin-bottom: 20px;
    text-align: center;
    color: #226752;
    font-size: 24px;
  `;let V=document.createElement("iframe"),J=B.url,Y=M("hubspotutk");if(Y){let I=J.includes("?")?"&":"?";J+=`${I}hubspotutk=${encodeURIComponent(Y)}`,console.log("Appended hubspotutk to iframe URL:",J)}try{let I=JSON.parse(localStorage.getItem("hubspot_form_data")||"{}"),X=new URLSearchParams;if(I.firstName)X.append("firstname",I.firstName);if(I.lastName)X.append("lastname",I.lastName);if(I.email)X.append("email",I.email);if([...X].length>0){let Z=J.includes("?")?"&":"?";J+=`${Z}${X.toString()}`,console.log("Appended prefill params to iframe URL:",J)}}catch(I){console.warn("Could not parse form data for prefill params",I)}if(V.src=J,V.style.cssText=`
    width: 100%;
    height: calc(100% - 60px);
    border: none;
  `,!document.querySelector('script[src*="MeetingsEmbedCode.js"]')){let I=document.createElement("script");I.type="text/javascript",I.src="https://static.hsappstatic.net/MeetingsEmbed/ex/MeetingsEmbedCode.js",I.async=!0,console.log("Injecting HubSpot Meetings script"),document.head.appendChild(I)}else console.log("HubSpot Meetings script already present");return H.appendChild(K),H.appendChild(V),H}function $(){try{let A=JSON.parse(localStorage.getItem("hubspot_form_data")||"{}");console.log("Initializing scheduler with stored form data:",{hasFormData:!!localStorage.getItem("hubspot_form_data"),formDataKeys:Object.keys(A)});let B=q(A);if(B===null){console.log("Calendar type is null, redirecting has occurred");return}let H=N(B);document.body.appendChild(H),console.log("Scheduler modal successfully mounted to DOM"),window.addEventListener("message",(K)=>{if(K.data.type==="CALENDAR_EVENT_SCHEDULED")console.log("Calendar event successfully scheduled, cleaning up form data"),localStorage.removeItem("hubspot_form_data"),H.remove()})}catch(A){console.error("Error initializing scheduler:",A),window.location.href="https://joinheard.com"}}function j(){if(console.log("Starting scheduler initialization guard checks"),window.location.pathname==="/thank-you/schedule")try{let A=localStorage.getItem("hubspot_form_data");if(console.log("Checking localStorage for form data:",{formDataExists:!!A,formDataLength:A?.length||0}),!A)throw console.log("No form data found in localStorage, redirecting to homepage"),window.location.href="https://joinheard.com",new Error("No form data found");try{JSON.parse(A),$()}catch(B){throw console.error("Invalid form data in localStorage:",B),window.location.href="https://joinheard.com",new Error("Invalid form data")}console.log("Valid form data found, initializing scheduler")}catch(A){console.error("Error checking form data:",A)}}if(document.readyState==="complete")j();else window.addEventListener("load",j);
})();