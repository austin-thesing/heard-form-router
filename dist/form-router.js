(function(){var A={FORM_FIELDS:{multiOwner:"is_your_practice_a_c_corp_or_our_does_it_have_multiple_owners_",state:"state",practiceSetup:"how_is_your_business_setup__v2",income:"what_is_your_expected_annual_income_for_2024___1099__private_practice_",practiceRunning:"how_long_have_you_been_running_your_private_practice_",profession:"what_best_describes_your_practice_",employeeCount:"does_your_practice_employ_any_w2_employees_or_1099_contractors_who_see_patients_"},HUBSPOT_CALENDARS:{SOLE_PROP:{url:"https://meetings.hubspot.com/bz/consultations?embed=true",title:"Schedule a Call"},S_CORP:{url:"https://meetings.hubspot.com/bz/consultation?embed=true",title:"Schedule a Call"}},LANDING_PAGES:{FREE_TRIAL:"/thank-you/free-trial",SCHEDULER:"/thank-you/schedule",NOT_QUALIFIED:"/thank-you/success"},DISQUALIFYING_CONDITIONS:{multiOwner:["yes"],state:["international"],practiceSetup:["c corp"],income:["none","less than $20,000"],profession:["dietician","nutritionist","massage therapist","dietician or nutritionist","dietetics or nutrition counseling"],practiceRunning:["opening practice in 1+ month","opening in 1+ months"],employeeCount:["yes (more than 10 employees)"]},INCOME_TIERS:{QUALIFIED_INCOME:["$20,000 - $49,999","$50,000 - $99,999","more than $100,000"]},determineRoute(B){let G=(B[this.FORM_FIELDS.multiOwner]||"").toLowerCase(),H=(B[this.FORM_FIELDS.state]||"").toLowerCase(),I=(B[this.FORM_FIELDS.practiceSetup]||"").toLowerCase(),K=(B[this.FORM_FIELDS.income]||"").toLowerCase(),J=(B[this.FORM_FIELDS.practiceRunning]||"").toLowerCase(),M=(B[this.FORM_FIELDS.profession]||"").toLowerCase(),N=(B[this.FORM_FIELDS.employeeCount]||"").toLowerCase();console.log("Form Router Debug:",{multiOwner:G,state:H,practiceSetup:I,income:K,practiceRunning:J,profession:M,employeeCount:N,formData:B});let P=this.DISQUALIFYING_CONDITIONS.multiOwner.includes(G)||this.DISQUALIFYING_CONDITIONS.state.includes(H)||this.DISQUALIFYING_CONDITIONS.practiceSetup.includes(I)||this.DISQUALIFYING_CONDITIONS.income.includes(K)||this.DISQUALIFYING_CONDITIONS.profession.some((L)=>M.includes(L))||this.DISQUALIFYING_CONDITIONS.practiceRunning.includes(J)||this.DISQUALIFYING_CONDITIONS.employeeCount.includes(N);if(console.log("isDQ",P),P)return console.log("Form Router: Not qualified due to DQ conditions"),"NOT_QUALIFIED";if(this.INCOME_TIERS.QUALIFIED_INCOME.some((L)=>K.includes(L)))return console.log("Form Router: Qualified for scheduler"),"SCHEDULER";return console.log("Form Router: Not qualified (default)"),"NOT_QUALIFIED"}};if(typeof window!=="undefined")window.FormRouterConfig=A;function W(){console.log("Form Router - Initializing form handler"),window.hbspt.forms.create({region:"na1",portalId:"7507639",formId:"0d9c387a-9c8b-40c4-8d46-3135f754f077",target:"#hubspot-form-container",onFormReady:function(B){console.log("Form Router - Form Ready"),console.log("Form Router - Config loaded:",!!A),console.log("Form Router - Adding field tracking"),B.find("input, select, textarea").each(function(){$(this).on("change",function(){console.log("Form Router - Field Changed:",{name:this.name,value:this.value,type:this.type||"textarea"})})})},onFormSubmit:function(B,G){if(!A)return console.error("Form Router - FormRouterConfig not found - ensure form-config.js is loaded"),!1;console.log("Form Router - Starting submission process"),console.log("Form Router - Raw HubSpot data:",G);let H={};if(G&&Array.isArray(G))console.log("Form Router - Income field in raw data:",G.find((I)=>I.name===A.FORM_FIELDS.income)),G.forEach((I)=>{let{value:K,name:J}=I;if(console.log("Form Router - Processing field:",{key:J,value:K}),J===A.FORM_FIELDS.employeeCount||J===A.FORM_FIELDS.practiceRunning)H[J]=K.toLowerCase().trim();else H[J]=K});else console.error("Form Router - No data received from HubSpot or invalid format:",G);try{console.log("Form Router - Final form data object before storage:",H),localStorage.setItem("hubspot_form_data",JSON.stringify(H)),console.log("Form Router - Stored form data:",H)}catch(I){console.error("Form Router - Storage failed:",I)}return!0},onFormSubmitted:function(B){if(!A)return console.error("Form Router - FormRouterConfig not found during submission - ensure form-config.js is loaded"),!1;return console.log("Form Router - Processing submission"),Z(),!1},onFormSubmitError:function(B,G){console.error("Form Router - HubSpot form submission error:",G,Object.fromEntries(new FormData(B)))}})}function X(B){let H=`; ${document.cookie}`.split(`; ${B}=`);if(H.length===2)return H.pop().split(";").shift();return null}function Y(B){return A.determineRoute(B)}if(window.hbspt)W();else window.addEventListener("load",function(){if(window.hbspt)W()});function Z(){try{let B=JSON.parse(localStorage.getItem("hubspot_form_data")||"{}");console.log("Form Router - Retrieved form data:",B),console.log("Form Router - Income field value:",B.income),console.log("Form Router - Income field type:",typeof B.income);let G=(B[A.FORM_FIELDS.multiOwner]||"").toLowerCase(),H=(B[A.FORM_FIELDS.state]||"").toLowerCase(),I=(B[A.FORM_FIELDS.practiceSetup]||"").toLowerCase(),K=(B[A.FORM_FIELDS.income]||"").toLowerCase(),J=(B[A.FORM_FIELDS.practiceRunning]||"").toLowerCase(),M=(B[A.FORM_FIELDS.profession]||"").toLowerCase(),N=(B[A.FORM_FIELDS.employeeCount]||"").toLowerCase();console.log("Form Router - DQ Condition Checks:",{multiOwner:{value:G,isDQ:A.DISQUALIFYING_CONDITIONS.multiOwner.includes(G),dqValues:A.DISQUALIFYING_CONDITIONS.multiOwner},state:{value:H,isDQ:A.DISQUALIFYING_CONDITIONS.state.includes(H),dqValues:A.DISQUALIFYING_CONDITIONS.state},practiceSetup:{value:I,isDQ:A.DISQUALIFYING_CONDITIONS.practiceSetup.includes(I),dqValues:A.DISQUALIFYING_CONDITIONS.practiceSetup},income:{value:K,isDQ:A.DISQUALIFYING_CONDITIONS.income.includes(K),dqValues:A.DISQUALIFYING_CONDITIONS.income},profession:{value:M,isDQ:A.DISQUALIFYING_CONDITIONS.profession.some((V)=>M.includes(V)),dqValues:A.DISQUALIFYING_CONDITIONS.profession},practiceRunning:{value:J,isDQ:A.DISQUALIFYING_CONDITIONS.practiceRunning.includes(J),dqValues:A.DISQUALIFYING_CONDITIONS.practiceRunning},employeeCount:{value:N,isDQ:A.DISQUALIFYING_CONDITIONS.employeeCount.includes(N),dqValues:A.DISQUALIFYING_CONDITIONS.employeeCount}});let P=Y(B);console.log("Form Router - Determined route:",P);let L=A.LANDING_PAGES[P]||A.LANDING_PAGES.NOT_QUALIFIED;console.log("Form Router - Base URL:",L);let T=X("hubspotutk");if(console.log("Form Router - Retrieved hutk:",T),T){let V=L.includes("?")?"&":"?";L+=`${V}hubspotUtk=${T}`,console.log("Form Router - Appended hutk to URL:",L)}else console.warn("Form Router - hubspotutk cookie not found. Cannot append to URL.");if(!A){console.error("Form Router - FormRouterConfig not found - form-config.js may not be loaded");return}setTimeout(()=>{console.log("Form Router - Executing redirect to:",L),window.location.href=L},700)}catch(B){console.error("Form Router - Redirect failed:",B);let G=A.LANDING_PAGES.NOT_QUALIFIED,H=X("hubspotutk");if(H){let I=G.includes("?")?"&":"?";G+=`${I}hubspotUtk=${H}`,console.log("Form Router - Appended hutk to fallback URL:",G)}window.location.href=G}}
})();