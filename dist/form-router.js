(function(){var B={FORM_FIELDS:{multiOwner:"is_your_practice_a_c_corp_or_our_does_it_have_multiple_owners_",state:"state",practiceSetup:"how_is_your_business_setup__v2",income:"what_is_your_expected_annual_income_for_2024___1099__private_practice_",practiceRunning:"how_long_have_you_been_running_your_private_practice_",profession:"what_best_describes_your_practice_",employeeCount:"does_your_practice_employ_any_w2_employees_or_1099_contractors_who_see_patients_"},HUBSPOT_CALENDARS:{SOLE_PROP:{url:"https://meetings.hubspot.com/bz/consultations?embed=true",title:"Schedule a Call"},S_CORP:{url:"https://meetings.hubspot.com/bz/consultation?embed=true",title:"Schedule a Call"}},LANDING_PAGES:{FREE_TRIAL:"/thank-you/free-trial",SCHEDULER:"/thank-you/schedule",NOT_QUALIFIED:"/thank-you/success"},DISQUALIFYING_CONDITIONS:{multiOwner:["yes"],state:["international"],practiceSetup:["c corp"],income:["none","less than $20,000"],profession:["dietician","nutritionist","massage therapist","dietician or nutritionist","dietetics or nutrition counseling"],practiceRunning:["opening practice in 1+ month","opening in 1+ months"],employeeCount:["yes (more than 10 employees)"]},INCOME_TIERS:{QUALIFIED_INCOME:["$20,000 - $49,999","$50,000 - $99,999","more than $100,000"]},determineRoute(q){let H=(q[this.FORM_FIELDS.multiOwner]||"").toLowerCase(),J=(q[this.FORM_FIELDS.state]||"").toLowerCase(),X=(q[this.FORM_FIELDS.practiceSetup]||"").toLowerCase(),K=(q[this.FORM_FIELDS.income]||"").toLowerCase(),M=(q[this.FORM_FIELDS.practiceRunning]||"").toLowerCase(),W=(q[this.FORM_FIELDS.profession]||"").toLowerCase(),Z=(q[this.FORM_FIELDS.employeeCount]||"").toLowerCase();console.log("Form Router Debug:",{multiOwner:H,state:J,practiceSetup:X,income:K,practiceRunning:M,profession:W,employeeCount:Z,formData:q});let P=this.DISQUALIFYING_CONDITIONS.multiOwner.includes(H)||this.DISQUALIFYING_CONDITIONS.state.includes(J)||this.DISQUALIFYING_CONDITIONS.practiceSetup.includes(X)||this.DISQUALIFYING_CONDITIONS.income.includes(K)||this.DISQUALIFYING_CONDITIONS.profession.some((Y)=>W.includes(Y))||this.DISQUALIFYING_CONDITIONS.practiceRunning.includes(M)||this.DISQUALIFYING_CONDITIONS.employeeCount.includes(Z);if(console.log("isDQ",P),P)return console.log("Form Router: Not qualified due to DQ conditions"),"NOT_QUALIFIED";console.log("Form Router: Checking income qualification. Current income value:",K),console.log("Form Router: Looking for income in qualified tiers:",this.INCOME_TIERS.QUALIFIED_INCOME);let T=this.INCOME_TIERS.QUALIFIED_INCOME.map((Y)=>{let x=K.includes(Y.toLowerCase());return console.log(`Form Router: Does income "${K}" include "${Y.toLowerCase()}"? ${x}`),x}).some((Y)=>Y===!0);if(console.log("Form Router: Is income qualified?",T),T)return console.log("Form Router: Qualified for scheduler"),"SCHEDULER";return console.log("Form Router: Not qualified (default)"),"NOT_QUALIFIED"}};if(typeof window!=="undefined")window.FormRouterConfig=B;function z(){console.log("Form Router - Initializing form handler"),window.hbspt.forms.create({region:"na1",portalId:"7507639",formId:"0d9c387a-9c8b-40c4-8d46-3135f754f077",target:"#hubspot-form-container",onFormReady:function(q){console.log("Form Router - Form Ready"),console.log("Form Router - Config loaded:",!!B),console.log("Form Router - Adding field tracking"),q.find("input, select, textarea").each(function(){$(this).on("change",function(){console.log("Form Router - Field Changed:",{name:this.name,value:this.value,type:this.type||"textarea"})})})},onFormSubmit:function(q){if(!B)return console.error("Form Router - FormRouterConfig not found - ensure form-config.js is loaded"),!1;console.log("Form Router - Starting submission process");let H=new FormData(q),J={};console.log("Form Router - Raw form fields:");for(let[M,W]of H.entries())console.log(`Field: "${M}" = "${W}"`);H.forEach((M,W)=>{if(W===B.FORM_FIELDS.employeeCount||W===B.FORM_FIELDS.practiceRunning)J[W]=M.toLowerCase().trim();else J[W]=M});let X=B.FORM_FIELDS.income,K=H.get(X);console.log(`Form Router - Checking income field directly: Name='${X}', Value='${K}'`);try{localStorage.setItem("hubspot_form_data",JSON.stringify(J)),console.log("Form Router - Stored form data:",J)}catch(M){console.error("Form Router - Storage failed:",M),Sentry.captureException(M,{extra:{context:"Form submission storage failed",formData:J},tags:{type:"local_storage",form:"hubspot_contact"}})}return!0},onFormSubmitted:function(q){if(!B)return console.error("Form Router - FormRouterConfig not found during submission - ensure form-config.js is loaded"),!1;return console.log("Form Router - Processing submission"),L(),!1},onFormSubmitError:function(q,H){Sentry.captureException(H,{extra:{context:"HubSpot form submission error",formData:Object.fromEntries(new FormData(q))},tags:{type:"hubspot_submission_error",form:"hubspot_contact"}})}})}function G(q){return B.determineRoute(q)}if(window.hbspt)z();else window.addEventListener("load",function(){if(window.hbspt)z()});function L(){try{let q=JSON.parse(localStorage.getItem("hubspot_form_data")||"{}");console.log("Form Router - Retrieved form data:",q);let H=B.FORM_FIELDS.income,J=q[H];console.log(`Form Router - Checking income field after storage retrieval: Name='${H}', Value='${J}', Type='${typeof J}'`),console.log("Form Router - Expected field names:",{multiOwner:B.FORM_FIELDS.multiOwner,state:B.FORM_FIELDS.state,practiceSetup:B.FORM_FIELDS.practiceSetup,income:B.FORM_FIELDS.income,practiceRunning:B.FORM_FIELDS.practiceRunning,profession:B.FORM_FIELDS.profession,employeeCount:B.FORM_FIELDS.employeeCount}),console.log("Form Router - Field existence check:",{multiOwner:q.hasOwnProperty(B.FORM_FIELDS.multiOwner),state:q.hasOwnProperty(B.FORM_FIELDS.state),practiceSetup:q.hasOwnProperty(B.FORM_FIELDS.practiceSetup),income:q.hasOwnProperty(B.FORM_FIELDS.income),practiceRunning:q.hasOwnProperty(B.FORM_FIELDS.practiceRunning),profession:q.hasOwnProperty(B.FORM_FIELDS.profession),employeeCount:q.hasOwnProperty(B.FORM_FIELDS.employeeCount)});let X=G(q);console.log("Form Router - Determined route:",X);let K=B.LANDING_PAGES[X]||B.LANDING_PAGES.NOT_QUALIFIED;if(console.log("Form Router - Final URL:",K),!B){console.error("Form Router - FormRouterConfig not found - form-config.js may not be loaded");return}setTimeout(()=>{console.log("Form Router - Executing redirect to:",K)},700)}catch(q){console.error("Form Router - Redirect failed:",q),Sentry.captureException(q,{extra:{context:"Post-submission redirect failed"},tags:{type:"redirect",form:"hubspot_contact"}})}}
})();